{
  "version": 3,
  "sources": ["../../datatables.net-buttons/js/buttons.html5.js"],
  "sourcesContent": ["/*!\r\n * HTML5 export buttons for Buttons and DataTables.\r\n * © SpryMedia Ltd - datatables.net/license\r\n *\r\n * FileSaver.js (1.3.3) - MIT license\r\n * Copyright © 2016 Eli Grey - http://eligrey.com\r\n */\r\n\r\n(function( factory ){\r\n\tif ( typeof define === 'function' && define.amd ) {\r\n\t\t// AMD\r\n\t\tdefine( ['jquery', 'datatables.net', 'datatables.net-buttons'], function ( $ ) {\r\n\t\t\treturn factory( $, window, document );\r\n\t\t} );\r\n\t}\r\n\telse if ( typeof exports === 'object' ) {\r\n\t\t// CommonJS\r\n\t\tvar jq = require('jquery');\r\n\t\tvar cjsRequires = function (root, $) {\r\n\t\t\tif ( ! $.fn.dataTable ) {\r\n\t\t\t\trequire('datatables.net')(root, $);\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! $.fn.dataTable.Buttons ) {\r\n\t\t\t\trequire('datatables.net-buttons')(root, $);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif (typeof window === 'undefined') {\r\n\t\t\tmodule.exports = function (root, $) {\r\n\t\t\t\tif ( ! root ) {\r\n\t\t\t\t\t// CommonJS environments without a window global must pass a\r\n\t\t\t\t\t// root. This will give an error otherwise\r\n\t\t\t\t\troot = window;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ! $ ) {\r\n\t\t\t\t\t$ = jq( root );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcjsRequires( root, $ );\r\n\t\t\t\treturn factory( $, root, root.document );\r\n\t\t\t};\r\n\t\t}\r\n\t\telse {\r\n\t\t\tcjsRequires( window, jq );\r\n\t\t\tmodule.exports = factory( jq, window, window.document );\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\t// Browser\r\n\t\tfactory( jQuery, window, document );\r\n\t}\r\n}(function( $, window, document ) {\r\n'use strict';\r\nvar DataTable = $.fn.dataTable;\r\n\r\n\r\n\r\n// Allow the constructor to pass in JSZip and PDFMake from external requires.\r\n// Otherwise, use globally defined variables, if they are available.\r\nvar useJszip;\r\nvar usePdfmake;\r\n\r\nfunction _jsZip() {\r\n\treturn useJszip || window.JSZip;\r\n}\r\nfunction _pdfMake() {\r\n\treturn usePdfmake || window.pdfMake;\r\n}\r\n\r\nDataTable.Buttons.pdfMake = function (_) {\r\n\tif (!_) {\r\n\t\treturn _pdfMake();\r\n\t}\r\n\tusePdfmake = _;\r\n};\r\n\r\nDataTable.Buttons.jszip = function (_) {\r\n\tif (!_) {\r\n\t\treturn _jsZip();\r\n\t}\r\n\tuseJszip = _;\r\n};\r\n\r\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n * FileSaver.js dependency\r\n */\r\n\r\n/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\r\n\r\nvar _saveAs = (function (view) {\r\n\t'use strict';\r\n\t// IE <10 is explicitly unsupported\r\n\tif (\r\n\t\ttypeof view === 'undefined' ||\r\n\t\t(typeof navigator !== 'undefined' &&\r\n\t\t\t/MSIE [1-9]\\./.test(navigator.userAgent))\r\n\t) {\r\n\t\treturn;\r\n\t}\r\n\tvar doc = view.document,\r\n\t\t// only get URL when necessary in case Blob.js hasn't overridden it yet\r\n\t\tget_URL = function () {\r\n\t\t\treturn view.URL || view.webkitURL || view;\r\n\t\t},\r\n\t\tsave_link = doc.createElementNS('http://www.w3.org/1999/xhtml', 'a'),\r\n\t\tcan_use_save_link = 'download' in save_link,\r\n\t\tclick = function (node) {\r\n\t\t\tvar event = new MouseEvent('click');\r\n\t\t\tnode.dispatchEvent(event);\r\n\t\t},\r\n\t\tis_safari = /constructor/i.test(view.HTMLElement) || view.safari,\r\n\t\tis_chrome_ios = /CriOS\\/[\\d]+/.test(navigator.userAgent),\r\n\t\tthrow_outside = function (ex) {\r\n\t\t\t(view.setImmediate || view.setTimeout)(function () {\r\n\t\t\t\tthrow ex;\r\n\t\t\t}, 0);\r\n\t\t},\r\n\t\tforce_saveable_type = 'application/octet-stream',\r\n\t\t// the Blob API is fundamentally broken as there is no \"downloadfinished\" event to subscribe to\r\n\t\tarbitrary_revoke_timeout = 1000 * 40, // in ms\r\n\t\trevoke = function (file) {\r\n\t\t\tvar revoker = function () {\r\n\t\t\t\tif (typeof file === 'string') {\r\n\t\t\t\t\t// file is an object URL\r\n\t\t\t\t\tget_URL().revokeObjectURL(file);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t// file is a File\r\n\t\t\t\t\tfile.remove();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tsetTimeout(revoker, arbitrary_revoke_timeout);\r\n\t\t},\r\n\t\tdispatch = function (filesaver, event_types, event) {\r\n\t\t\tevent_types = [].concat(event_types);\r\n\t\t\tvar i = event_types.length;\r\n\t\t\twhile (i--) {\r\n\t\t\t\tvar listener = filesaver['on' + event_types[i]];\r\n\t\t\t\tif (typeof listener === 'function') {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tlistener.call(filesaver, event || filesaver);\r\n\t\t\t\t\t} catch (ex) {\r\n\t\t\t\t\t\tthrow_outside(ex);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tauto_bom = function (blob) {\r\n\t\t\t// prepend BOM for UTF-8 XML and text/* types (including HTML)\r\n\t\t\t// note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\r\n\t\t\tif (\r\n\t\t\t\t/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(\r\n\t\t\t\t\tblob.type\r\n\t\t\t\t)\r\n\t\t\t) {\r\n\t\t\t\treturn new Blob([String.fromCharCode(0xfeff), blob], {\r\n\t\t\t\t\ttype: blob.type\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn blob;\r\n\t\t},\r\n\t\tFileSaver = function (blob, name, no_auto_bom) {\r\n\t\t\tif (!no_auto_bom) {\r\n\t\t\t\tblob = auto_bom(blob);\r\n\t\t\t}\r\n\t\t\t// First try a.download, then web filesystem, then object URLs\r\n\t\t\tvar filesaver = this,\r\n\t\t\t\ttype = blob.type,\r\n\t\t\t\tforce = type === force_saveable_type,\r\n\t\t\t\tobject_url,\r\n\t\t\t\tdispatch_all = function () {\r\n\t\t\t\t\tdispatch(\r\n\t\t\t\t\t\tfilesaver,\r\n\t\t\t\t\t\t'writestart progress write writeend'.split(' ')\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\t// on any filesys errors revert to saving with object URLs\r\n\t\t\t\tfs_error = function () {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\t(is_chrome_ios || (force && is_safari)) &&\r\n\t\t\t\t\t\tview.FileReader\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\t// Safari doesn't allow downloading of blob urls\r\n\t\t\t\t\t\tvar reader = new FileReader();\r\n\t\t\t\t\t\treader.onloadend = function () {\r\n\t\t\t\t\t\t\tvar url = is_chrome_ios\r\n\t\t\t\t\t\t\t\t? reader.result\r\n\t\t\t\t\t\t\t\t: reader.result.replace(\r\n\t\t\t\t\t\t\t\t\t\t/^data:[^;]*;/,\r\n\t\t\t\t\t\t\t\t\t\t'data:attachment/file;'\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tvar popup = view.open(url, '_blank');\r\n\t\t\t\t\t\t\tif (!popup) view.location.href = url;\r\n\t\t\t\t\t\t\turl = undefined; // release reference before dispatching\r\n\t\t\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\r\n\t\t\t\t\t\t\tdispatch_all();\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\treader.readAsDataURL(blob);\r\n\t\t\t\t\t\tfilesaver.readyState = filesaver.INIT;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// don't create more object URLs than needed\r\n\t\t\t\t\tif (!object_url) {\r\n\t\t\t\t\t\tobject_url = get_URL().createObjectURL(blob);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (force) {\r\n\t\t\t\t\t\tview.location.href = object_url;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tvar opened = view.open(object_url, '_blank');\r\n\t\t\t\t\t\tif (!opened) {\r\n\t\t\t\t\t\t\t// Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\r\n\t\t\t\t\t\t\tview.location.href = object_url;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\r\n\t\t\t\t\tdispatch_all();\r\n\t\t\t\t\trevoke(object_url);\r\n\t\t\t\t};\r\n\t\t\tfilesaver.readyState = filesaver.INIT;\r\n\r\n\t\t\tif (can_use_save_link) {\r\n\t\t\t\tobject_url = get_URL().createObjectURL(blob);\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\tsave_link.href = object_url;\r\n\t\t\t\t\tsave_link.download = name;\r\n\t\t\t\t\tclick(save_link);\r\n\t\t\t\t\tdispatch_all();\r\n\t\t\t\t\trevoke(object_url);\r\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfs_error();\r\n\t\t},\r\n\t\tFS_proto = FileSaver.prototype,\r\n\t\tsaveAs = function (blob, name, no_auto_bom) {\r\n\t\t\treturn new FileSaver(\r\n\t\t\t\tblob,\r\n\t\t\t\tname || blob.name || 'download',\r\n\t\t\t\tno_auto_bom\r\n\t\t\t);\r\n\t\t};\r\n\t// IE 10+ (native saveAs)\r\n\tif (typeof navigator !== 'undefined' && navigator.msSaveOrOpenBlob) {\r\n\t\treturn function (blob, name, no_auto_bom) {\r\n\t\t\tname = name || blob.name || 'download';\r\n\r\n\t\t\tif (!no_auto_bom) {\r\n\t\t\t\tblob = auto_bom(blob);\r\n\t\t\t}\r\n\t\t\treturn navigator.msSaveOrOpenBlob(blob, name);\r\n\t\t};\r\n\t}\r\n\r\n\tFS_proto.abort = function () {};\r\n\tFS_proto.readyState = FS_proto.INIT = 0;\r\n\tFS_proto.WRITING = 1;\r\n\tFS_proto.DONE = 2;\r\n\r\n\tFS_proto.error =\r\n\t\tFS_proto.onwritestart =\r\n\t\tFS_proto.onprogress =\r\n\t\tFS_proto.onwrite =\r\n\t\tFS_proto.onabort =\r\n\t\tFS_proto.onerror =\r\n\t\tFS_proto.onwriteend =\r\n\t\t\tnull;\r\n\r\n\treturn saveAs;\r\n})(\r\n\t(typeof self !== 'undefined' && self) ||\r\n\t\t(typeof window !== 'undefined' && window) ||\r\n\t\tthis.content\r\n);\r\n\r\n// Expose file saver on the DataTables API. Can't attach to `DataTables.Buttons`\r\n// since this file can be loaded before Button's core!\r\nDataTable.fileSave = _saveAs;\r\n\r\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n * Local (private) functions\r\n */\r\n\r\n/**\r\n * Get the sheet name for Excel exports.\r\n *\r\n * @param {object}\tconfig Button configuration\r\n */\r\nvar _sheetname = function (config) {\r\n\tvar sheetName = 'Sheet1';\r\n\r\n\tif (config.sheetName) {\r\n\t\tsheetName = config.sheetName.replace(/[\\[\\]\\*\\/\\\\\\?\\:]/g, '');\r\n\t}\r\n\r\n\treturn sheetName;\r\n};\r\n\r\n/**\r\n * Get the newline character(s)\r\n *\r\n * @param {object}\tconfig Button configuration\r\n * @return {string}\t\t\t\tNewline character\r\n */\r\nvar _newLine = function (config) {\r\n\treturn config.newline\r\n\t\t? config.newline\r\n\t\t: navigator.userAgent.match(/Windows/)\r\n\t\t? '\\r\\n'\r\n\t\t: '\\n';\r\n};\r\n\r\n/**\r\n * Combine the data from the `buttons.exportData` method into a string that\r\n * will be used in the export file.\r\n *\r\n * @param\t{DataTable.Api} dt\t\t DataTables API instance\r\n * @param\t{object}\t\t\t\tconfig Button configuration\r\n * @return {object}\t\t\t\t\t\t\t The data to export\r\n */\r\nvar _exportData = function (dt, config) {\r\n\tvar newLine = _newLine(config);\r\n\tvar data = dt.buttons.exportData(config.exportOptions);\r\n\tvar boundary = config.fieldBoundary;\r\n\tvar separator = config.fieldSeparator;\r\n\tvar reBoundary = new RegExp(boundary, 'g');\r\n\tvar escapeChar = config.escapeChar !== undefined ? config.escapeChar : '\\\\';\r\n\tvar join = function (a) {\r\n\t\tvar s = '';\r\n\r\n\t\t// If there is a field boundary, then we might need to escape it in\r\n\t\t// the source data\r\n\t\tfor (var i = 0, ien = a.length; i < ien; i++) {\r\n\t\t\tif (i > 0) {\r\n\t\t\t\ts += separator;\r\n\t\t\t}\r\n\r\n\t\t\ts += boundary\r\n\t\t\t\t? boundary +\r\n\t\t\t\t('' + a[i]).replace(reBoundary, escapeChar + boundary) +\r\n\t\t\t\tboundary\r\n\t\t\t\t: a[i];\r\n\t\t}\r\n\r\n\t\treturn s;\r\n\t};\r\n\r\n\tvar header = '';\r\n\tvar footer = '';\r\n\tvar body = [];\r\n\r\n\tif (config.header) {\r\n\t\theader =\r\n\t\t\tdata.headerStructure\r\n\t\t\t\t.map(function (row) {\r\n\t\t\t\t\treturn join(\r\n\t\t\t\t\t\trow.map(function (cell) {\r\n\t\t\t\t\t\t\treturn cell ? cell.title : '';\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\t\t\t\t})\r\n\t\t\t\t.join(newLine) + newLine;\r\n\t}\r\n\r\n\tif (config.footer && data.footer) {\r\n\t\tfooter =\r\n\t\t\tdata.footerStructure\r\n\t\t\t\t.map(function (row) {\r\n\t\t\t\t\treturn join(\r\n\t\t\t\t\t\trow.map(function (cell) {\r\n\t\t\t\t\t\t\treturn cell ? cell.title : '';\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\t\t\t\t})\r\n\t\t\t\t.join(newLine) + newLine;\r\n\t}\r\n\r\n\tfor (var i = 0, ien = data.body.length; i < ien; i++) {\r\n\t\tbody.push(join(data.body[i]));\r\n\t}\r\n\r\n\treturn {\r\n\t\tstr: header + body.join(newLine) + newLine + footer,\r\n\t\trows: body.length\r\n\t};\r\n};\r\n\r\n/**\r\n * Older versions of Safari (prior to tech preview 18) don't support the\r\n * download option required.\r\n *\r\n * @return {Boolean} `true` if old Safari\r\n */\r\nvar _isDuffSafari = function () {\r\n\tvar safari =\r\n\t\tnavigator.userAgent.indexOf('Safari') !== -1 &&\r\n\t\tnavigator.userAgent.indexOf('Chrome') === -1 &&\r\n\t\tnavigator.userAgent.indexOf('Opera') === -1;\r\n\r\n\tif (!safari) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tvar version = navigator.userAgent.match(/AppleWebKit\\/(\\d+\\.\\d+)/);\r\n\tif (version && version.length > 1 && version[1] * 1 < 603.1) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn false;\r\n};\r\n\r\n/**\r\n * Convert from numeric position to letter for column names in Excel\r\n * @param  {int} n Column number\r\n * @return {string} Column letter(s) name\r\n */\r\nfunction createCellPos(n) {\r\n\tvar ordA = 'A'.charCodeAt(0);\r\n\tvar ordZ = 'Z'.charCodeAt(0);\r\n\tvar len = ordZ - ordA + 1;\r\n\tvar s = '';\r\n\r\n\twhile (n >= 0) {\r\n\t\ts = String.fromCharCode((n % len) + ordA) + s;\r\n\t\tn = Math.floor(n / len) - 1;\r\n\t}\r\n\r\n\treturn s;\r\n}\r\n\r\ntry {\r\n\tvar _serialiser = new XMLSerializer();\r\n\tvar _ieExcel;\r\n} catch (t) {\r\n\t// noop\r\n}\r\n\r\n/**\r\n * Recursively add XML files from an object's structure to a ZIP file. This\r\n * allows the XSLX file to be easily defined with an object's structure matching\r\n * the files structure.\r\n *\r\n * @param {JSZip} zip ZIP package\r\n * @param {object} obj Object to add (recursive)\r\n */\r\nfunction _addToZip(zip, obj) {\r\n\tif (_ieExcel === undefined) {\r\n\t\t// Detect if we are dealing with IE's _awful_ serialiser by seeing if it\r\n\t\t// drop attributes\r\n\t\t_ieExcel =\r\n\t\t\t_serialiser\r\n\t\t\t\t.serializeToString(\r\n\t\t\t\t\tnew window.DOMParser().parseFromString(\r\n\t\t\t\t\t\texcelStrings['xl/worksheets/sheet1.xml'],\r\n\t\t\t\t\t\t'text/xml'\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t\t.indexOf('xmlns:r') === -1;\r\n\t}\r\n\r\n\t$.each(obj, function (name, val) {\r\n\t\tif ($.isPlainObject(val)) {\r\n\t\t\tvar newDir = zip.folder(name);\r\n\t\t\t_addToZip(newDir, val);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (_ieExcel) {\r\n\t\t\t\t// IE's XML serialiser will drop some name space attributes from\r\n\t\t\t\t// from the root node, so we need to save them. Do this by\r\n\t\t\t\t// replacing the namespace nodes with a regular attribute that\r\n\t\t\t\t// we convert back when serialised. Edge does not have this\r\n\t\t\t\t// issue\r\n\t\t\t\tvar worksheet = val.childNodes[0];\r\n\t\t\t\tvar i, ien;\r\n\t\t\t\tvar attrs = [];\r\n\r\n\t\t\t\tfor (i = worksheet.attributes.length - 1; i >= 0; i--) {\r\n\t\t\t\t\tvar attrName = worksheet.attributes[i].nodeName;\r\n\t\t\t\t\tvar attrValue = worksheet.attributes[i].nodeValue;\r\n\r\n\t\t\t\t\tif (attrName.indexOf(':') !== -1) {\r\n\t\t\t\t\t\tattrs.push({ name: attrName, value: attrValue });\r\n\r\n\t\t\t\t\t\tworksheet.removeAttribute(attrName);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (i = 0, ien = attrs.length; i < ien; i++) {\r\n\t\t\t\t\tvar attr = val.createAttribute(\r\n\t\t\t\t\t\tattrs[i].name.replace(':', '_dt_b_namespace_token_')\r\n\t\t\t\t\t);\r\n\t\t\t\t\tattr.value = attrs[i].value;\r\n\t\t\t\t\tworksheet.setAttributeNode(attr);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar str = _serialiser.serializeToString(val);\r\n\r\n\t\t\t// Fix IE's XML\r\n\t\t\tif (_ieExcel) {\r\n\t\t\t\t// IE doesn't include the XML declaration\r\n\t\t\t\tif (str.indexOf('<?xml') === -1) {\r\n\t\t\t\t\tstr =\r\n\t\t\t\t\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\r\n\t\t\t\t\t\tstr;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Return namespace attributes to being as such\r\n\t\t\t\tstr = str.replace(/_dt_b_namespace_token_/g, ':');\r\n\r\n\t\t\t\t// Remove testing name space that IE puts into the space preserve attr\r\n\t\t\t\tstr = str.replace(/xmlns:NS[\\d]+=\"\" NS[\\d]+:/g, '');\r\n\t\t\t}\r\n\r\n\t\t\t// Safari, IE and Edge will put empty name space attributes onto\r\n\t\t\t// various elements making them useless. This strips them out\r\n\t\t\tstr = str.replace(/<([^<>]*?) xmlns=\"\"([^<>]*?)>/g, '<$1 $2>');\r\n\r\n\t\t\tzip.file(name, str);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/**\r\n * Create an XML node and add any children, attributes, etc without needing to\r\n * be verbose in the DOM.\r\n *\r\n * @param  {object} doc      XML document\r\n * @param  {string} nodeName Node name\r\n * @param  {object} opts     Options - can be `attr` (attributes), `children`\r\n *   (child nodes) and `text` (text content)\r\n * @return {node}            Created node\r\n */\r\nfunction _createNode(doc, nodeName, opts) {\r\n\tvar tempNode = doc.createElement(nodeName);\r\n\r\n\tif (opts) {\r\n\t\tif (opts.attr) {\r\n\t\t\t$(tempNode).attr(opts.attr);\r\n\t\t}\r\n\r\n\t\tif (opts.children) {\r\n\t\t\t$.each(opts.children, function (key, value) {\r\n\t\t\t\ttempNode.appendChild(value);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (opts.text !== null && opts.text !== undefined) {\r\n\t\t\ttempNode.appendChild(doc.createTextNode(opts.text));\r\n\t\t}\r\n\t}\r\n\r\n\treturn tempNode;\r\n}\r\n\r\n/**\r\n * Get the width for an Excel column based on the contents of that column\r\n * @param  {object} data Data for export\r\n * @param  {int}    col  Column index\r\n * @return {int}         Column width\r\n */\r\nfunction _excelColWidth(data, col) {\r\n\tvar max = data.header[col].length;\r\n\tvar len, lineSplit, str;\r\n\r\n\tif (data.footer && data.footer[col] && data.footer[col].length > max) {\r\n\t\tmax = data.footer[col].length;\r\n\t}\r\n\r\n\tfor (var i = 0, ien = data.body.length; i < ien; i++) {\r\n\t\tvar point = data.body[i][col];\r\n\t\tstr = point !== null && point !== undefined ? point.toString() : '';\r\n\r\n\t\t// If there is a newline character, workout the width of the column\r\n\t\t// based on the longest line in the string\r\n\t\tif (str.indexOf('\\n') !== -1) {\r\n\t\t\tlineSplit = str.split('\\n');\r\n\t\t\tlineSplit.sort(function (a, b) {\r\n\t\t\t\treturn b.length - a.length;\r\n\t\t\t});\r\n\r\n\t\t\tlen = lineSplit[0].length;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlen = str.length;\r\n\t\t}\r\n\r\n\t\tif (len > max) {\r\n\t\t\tmax = len;\r\n\t\t}\r\n\r\n\t\t// Max width rather than having potentially massive column widths\r\n\t\tif (max > 40) {\r\n\t\t\treturn 54; // 40 * 1.35\r\n\t\t}\r\n\t}\r\n\r\n\tmax *= 1.35;\r\n\r\n\t// And a min width\r\n\treturn max > 6 ? max : 6;\r\n}\r\n\r\n// Excel - Pre-defined strings to build a basic XLSX file\r\nvar excelStrings = {\r\n\t'_rels/.rels':\r\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\r\n\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' +\r\n\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>' +\r\n\t\t'</Relationships>',\r\n\r\n\t'xl/_rels/workbook.xml.rels':\r\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\r\n\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' +\r\n\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>' +\r\n\t\t'<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>' +\r\n\t\t'</Relationships>',\r\n\r\n\t'[Content_Types].xml':\r\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\r\n\t\t'<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">' +\r\n\t\t'<Default Extension=\"xml\" ContentType=\"application/xml\" />' +\r\n\t\t'<Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" />' +\r\n\t\t'<Default Extension=\"jpeg\" ContentType=\"image/jpeg\" />' +\r\n\t\t'<Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" />' +\r\n\t\t'<Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" />' +\r\n\t\t'<Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" />' +\r\n\t\t'</Types>',\r\n\r\n\t'xl/workbook.xml':\r\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\r\n\t\t'<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">' +\r\n\t\t'<fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"24816\"/>' +\r\n\t\t'<workbookPr showInkAnnotation=\"0\" autoCompressPictures=\"0\"/>' +\r\n\t\t'<bookViews>' +\r\n\t\t'<workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"25600\" windowHeight=\"19020\" tabRatio=\"500\"/>' +\r\n\t\t'</bookViews>' +\r\n\t\t'<sheets>' +\r\n\t\t'<sheet name=\"Sheet1\" sheetId=\"1\" r:id=\"rId1\"/>' +\r\n\t\t'</sheets>' +\r\n\t\t'<definedNames/>' +\r\n\t\t'</workbook>',\r\n\r\n\t'xl/worksheets/sheet1.xml':\r\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\r\n\t\t'<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">' +\r\n\t\t'<sheetData/>' +\r\n\t\t'<mergeCells count=\"0\"/>' +\r\n\t\t'</worksheet>',\r\n\r\n\t'xl/styles.xml':\r\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\"?>' +\r\n\t\t'<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">' +\r\n\t\t'<numFmts count=\"6\">' +\r\n\t\t'<numFmt numFmtId=\"164\" formatCode=\"[$$-409]#,##0.00;-[$$-409]#,##0.00\"/>' +\r\n\t\t'<numFmt numFmtId=\"165\" formatCode=\"&quot;£&quot;#,##0.00\"/>' +\r\n\t\t'<numFmt numFmtId=\"166\" formatCode=\"[$€-2] #,##0.00\"/>' +\r\n\t\t'<numFmt numFmtId=\"167\" formatCode=\"0.0%\"/>' +\r\n\t\t'<numFmt numFmtId=\"168\" formatCode=\"#,##0;(#,##0)\"/>' +\r\n\t\t'<numFmt numFmtId=\"169\" formatCode=\"#,##0.00;(#,##0.00)\"/>' +\r\n\t\t'</numFmts>' +\r\n\t\t'<fonts count=\"5\" x14ac:knownFonts=\"1\">' +\r\n\t\t'<font>' +\r\n\t\t'<sz val=\"11\" />' +\r\n\t\t'<name val=\"Calibri\" />' +\r\n\t\t'</font>' +\r\n\t\t'<font>' +\r\n\t\t'<sz val=\"11\" />' +\r\n\t\t'<name val=\"Calibri\" />' +\r\n\t\t'<color rgb=\"FFFFFFFF\" />' +\r\n\t\t'</font>' +\r\n\t\t'<font>' +\r\n\t\t'<sz val=\"11\" />' +\r\n\t\t'<name val=\"Calibri\" />' +\r\n\t\t'<b />' +\r\n\t\t'</font>' +\r\n\t\t'<font>' +\r\n\t\t'<sz val=\"11\" />' +\r\n\t\t'<name val=\"Calibri\" />' +\r\n\t\t'<i />' +\r\n\t\t'</font>' +\r\n\t\t'<font>' +\r\n\t\t'<sz val=\"11\" />' +\r\n\t\t'<name val=\"Calibri\" />' +\r\n\t\t'<u />' +\r\n\t\t'</font>' +\r\n\t\t'</fonts>' +\r\n\t\t'<fills count=\"6\">' +\r\n\t\t'<fill>' +\r\n\t\t'<patternFill patternType=\"none\" />' +\r\n\t\t'</fill>' +\r\n\t\t'<fill>' + // Excel appears to use this as a dotted background regardless of values but\r\n\t\t'<patternFill patternType=\"none\" />' + // to be valid to the schema, use a patternFill\r\n\t\t'</fill>' +\r\n\t\t'<fill>' +\r\n\t\t'<patternFill patternType=\"solid\">' +\r\n\t\t'<fgColor rgb=\"FFD9D9D9\" />' +\r\n\t\t'<bgColor indexed=\"64\" />' +\r\n\t\t'</patternFill>' +\r\n\t\t'</fill>' +\r\n\t\t'<fill>' +\r\n\t\t'<patternFill patternType=\"solid\">' +\r\n\t\t'<fgColor rgb=\"FFD99795\" />' +\r\n\t\t'<bgColor indexed=\"64\" />' +\r\n\t\t'</patternFill>' +\r\n\t\t'</fill>' +\r\n\t\t'<fill>' +\r\n\t\t'<patternFill patternType=\"solid\">' +\r\n\t\t'<fgColor rgb=\"ffc6efce\" />' +\r\n\t\t'<bgColor indexed=\"64\" />' +\r\n\t\t'</patternFill>' +\r\n\t\t'</fill>' +\r\n\t\t'<fill>' +\r\n\t\t'<patternFill patternType=\"solid\">' +\r\n\t\t'<fgColor rgb=\"ffc6cfef\" />' +\r\n\t\t'<bgColor indexed=\"64\" />' +\r\n\t\t'</patternFill>' +\r\n\t\t'</fill>' +\r\n\t\t'</fills>' +\r\n\t\t'<borders count=\"2\">' +\r\n\t\t'<border>' +\r\n\t\t'<left />' +\r\n\t\t'<right />' +\r\n\t\t'<top />' +\r\n\t\t'<bottom />' +\r\n\t\t'<diagonal />' +\r\n\t\t'</border>' +\r\n\t\t'<border diagonalUp=\"false\" diagonalDown=\"false\">' +\r\n\t\t'<left style=\"thin\">' +\r\n\t\t'<color auto=\"1\" />' +\r\n\t\t'</left>' +\r\n\t\t'<right style=\"thin\">' +\r\n\t\t'<color auto=\"1\" />' +\r\n\t\t'</right>' +\r\n\t\t'<top style=\"thin\">' +\r\n\t\t'<color auto=\"1\" />' +\r\n\t\t'</top>' +\r\n\t\t'<bottom style=\"thin\">' +\r\n\t\t'<color auto=\"1\" />' +\r\n\t\t'</bottom>' +\r\n\t\t'<diagonal />' +\r\n\t\t'</border>' +\r\n\t\t'</borders>' +\r\n\t\t'<cellStyleXfs count=\"1\">' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" />' +\r\n\t\t'</cellStyleXfs>' +\r\n\t\t'<cellXfs count=\"68\">' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' +\r\n\t\t'<alignment horizontal=\"left\"/>' +\r\n\t\t'</xf>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' +\r\n\t\t'<alignment horizontal=\"center\"/>' +\r\n\t\t'</xf>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' +\r\n\t\t'<alignment horizontal=\"right\"/>' +\r\n\t\t'</xf>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' +\r\n\t\t'<alignment horizontal=\"fill\"/>' +\r\n\t\t'</xf>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' +\r\n\t\t'<alignment textRotation=\"90\"/>' +\r\n\t\t'</xf>' +\r\n\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' +\r\n\t\t'<alignment wrapText=\"1\"/>' +\r\n\t\t'</xf>' +\r\n\t\t'<xf numFmtId=\"9\"   fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"164\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"165\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"166\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"167\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"168\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"169\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"3\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"4\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"1\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"2\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' +\r\n\t\t'<xf numFmtId=\"14\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' +\r\n\t\t'</cellXfs>' +\r\n\t\t'<cellStyles count=\"1\">' +\r\n\t\t'<cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\" />' +\r\n\t\t'</cellStyles>' +\r\n\t\t'<dxfs count=\"0\" />' +\r\n\t\t'<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\" />' +\r\n\t\t'</styleSheet>'\r\n};\r\n// Note we could use 3 `for` loops for the styles, but when gzipped there is\r\n// virtually no difference in size, since the above can be easily compressed\r\n\r\n// Pattern matching for special number formats. Perhaps this should be exposed\r\n// via an API in future?\r\n// Ref: section 3.8.30 - built in formatters in open spreadsheet\r\n//   https://www.ecma-international.org/news/TC45_current_work/Office%20Open%20XML%20Part%204%20-%20Markup%20Language%20Reference.pdf\r\nvar _excelSpecials = [\r\n\t{\r\n\t\tmatch: /^\\-?\\d+\\.\\d%$/,\r\n\t\tstyle: 60,\r\n\t\tfmt: function (d) {\r\n\t\t\treturn d / 100;\r\n\t\t}\r\n\t}, // Percent with d.p.\r\n\t{\r\n\t\tmatch: /^\\-?\\d+\\.?\\d*%$/,\r\n\t\tstyle: 56,\r\n\t\tfmt: function (d) {\r\n\t\t\treturn d / 100;\r\n\t\t}\r\n\t}, // Percent\r\n\t{ match: /^\\-?\\$[\\d,]+.?\\d*$/, style: 57 }, // Dollars\r\n\t{ match: /^\\-?£[\\d,]+.?\\d*$/, style: 58 }, // Pounds\r\n\t{ match: /^\\-?€[\\d,]+.?\\d*$/, style: 59 }, // Euros\r\n\t{ match: /^\\-?\\d+$/, style: 65 }, // Numbers without thousand separators\r\n\t{ match: /^\\-?\\d+\\.\\d{2}$/, style: 66 }, // Numbers 2 d.p. without thousands separators\r\n\t{\r\n\t\tmatch: /^\\([\\d,]+\\)$/,\r\n\t\tstyle: 61,\r\n\t\tfmt: function (d) {\r\n\t\t\treturn -1 * d.replace(/[\\(\\)]/g, '');\r\n\t\t}\r\n\t}, // Negative numbers indicated by brackets\r\n\t{\r\n\t\tmatch: /^\\([\\d,]+\\.\\d{2}\\)$/,\r\n\t\tstyle: 62,\r\n\t\tfmt: function (d) {\r\n\t\t\treturn -1 * d.replace(/[\\(\\)]/g, '');\r\n\t\t}\r\n\t}, // Negative numbers indicated by brackets - 2d.p.\r\n\t{ match: /^\\-?[\\d,]+$/, style: 63 }, // Numbers with thousand separators\r\n\t{ match: /^\\-?[\\d,]+\\.\\d{2}$/, style: 64 },\r\n\t{\r\n\t\tmatch: /^(19\\d\\d|[2-9]\\d\\d\\d)\\-(0\\d|1[012])\\-[0123][\\d]$/,\r\n\t\tstyle: 67,\r\n\t\tfmt: function (d) {\r\n\t\t\treturn Math.round(25569 + Date.parse(d) / (86400 * 1000));\r\n\t\t}\r\n\t} //Date yyyy-mm-dd\r\n];\r\n\r\nvar _excelMergeCells = function (rels, row, column, rowspan, colspan) {\r\n\tvar mergeCells = $('mergeCells', rels);\r\n\r\n\tmergeCells[0].appendChild(\r\n\t\t_createNode(rels, 'mergeCell', {\r\n\t\t\tattr: {\r\n\t\t\t\tref:\r\n\t\t\t\t\tcreateCellPos(column) +\r\n\t\t\t\t\trow +\r\n\t\t\t\t\t':' +\r\n\t\t\t\t\tcreateCellPos(column + colspan - 1) +\r\n\t\t\t\t\t(row + rowspan - 1)\r\n\t\t\t}\r\n\t\t})\r\n\t);\r\n\r\n\tmergeCells.attr('count', parseFloat(mergeCells.attr('count')) + 1);\r\n};\r\n\r\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n * Buttons\r\n */\r\n\r\n//\r\n// Copy to clipboard\r\n//\r\nDataTable.ext.buttons.copyHtml5 = {\r\n\tclassName: 'buttons-copy buttons-html5',\r\n\r\n\ttext: function (dt) {\r\n\t\treturn dt.i18n('buttons.copy', 'Copy');\r\n\t},\r\n\r\n\taction: function (e, dt, button, config, cb) {\r\n\t\tvar exportData = _exportData(dt, config);\r\n\t\tvar info = dt.buttons.exportInfo(config);\r\n\t\tvar newline = _newLine(config);\r\n\t\tvar output = exportData.str;\r\n\t\tvar hiddenDiv = $('<div/>').css({\r\n\t\t\theight: 1,\r\n\t\t\twidth: 1,\r\n\t\t\toverflow: 'hidden',\r\n\t\t\tposition: 'fixed',\r\n\t\t\ttop: 0,\r\n\t\t\tleft: 0\r\n\t\t});\r\n\r\n\t\tif (info.title) {\r\n\t\t\toutput = info.title + newline + newline + output;\r\n\t\t}\r\n\r\n\t\tif (info.messageTop) {\r\n\t\t\toutput = info.messageTop + newline + newline + output;\r\n\t\t}\r\n\r\n\t\tif (info.messageBottom) {\r\n\t\t\toutput = output + newline + newline + info.messageBottom;\r\n\t\t}\r\n\r\n\t\tif (config.customize) {\r\n\t\t\toutput = config.customize(output, config, dt);\r\n\t\t}\r\n\r\n\t\tvar textarea = $('<textarea readonly/>')\r\n\t\t\t.val(output)\r\n\t\t\t.appendTo(hiddenDiv);\r\n\r\n\t\t// For browsers that support the copy execCommand, try to use it\r\n\t\tif (document.queryCommandSupported('copy')) {\r\n\t\t\thiddenDiv.appendTo(dt.table().container());\r\n\t\t\ttextarea[0].focus();\r\n\t\t\ttextarea[0].select();\r\n\r\n\t\t\ttry {\r\n\t\t\t\tvar successful = document.execCommand('copy');\r\n\t\t\t\thiddenDiv.remove();\r\n\r\n\t\t\t\tif (successful) {\r\n\t\t\t\t\tif (config.copySuccess) {\r\n\t\t\t\t\t\tdt.buttons.info(\r\n\t\t\t\t\t\t\tdt.i18n('buttons.copyTitle', 'Copy to clipboard'),\r\n\t\t\t\t\t\t\tdt.i18n(\r\n\t\t\t\t\t\t\t\t'buttons.copySuccess',\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t1: 'Copied one row to clipboard',\r\n\t\t\t\t\t\t\t\t\t_: 'Copied %d rows to clipboard'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\texportData.rows\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t2000\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcb();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t} catch (t) {\r\n\t\t\t\t// noop\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Otherwise we show the text box and instruct the user to use it\r\n\t\tvar message = $(\r\n\t\t\t'<span>' +\r\n\t\t\t\tdt.i18n(\r\n\t\t\t\t\t'buttons.copyKeys',\r\n\t\t\t\t\t'Press <i>ctrl</i> or <i>\\u2318</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>' +\r\n\t\t\t\t\t\t'To cancel, click this message or press escape.'\r\n\t\t\t\t) +\r\n\t\t\t\t'</span>'\r\n\t\t).append(hiddenDiv);\r\n\r\n\t\tdt.buttons.info(\r\n\t\t\tdt.i18n('buttons.copyTitle', 'Copy to clipboard'),\r\n\t\t\tmessage,\r\n\t\t\t0\r\n\t\t);\r\n\r\n\t\t// Select the text so when the user activates their system clipboard\r\n\t\t// it will copy that text\r\n\t\ttextarea[0].focus();\r\n\t\ttextarea[0].select();\r\n\r\n\t\t// Event to hide the message when the user is done\r\n\t\tvar container = $(message).closest('.dt-button-info');\r\n\t\tvar close = function () {\r\n\t\t\tcontainer.off('click.buttons-copy');\r\n\t\t\t$(document).off('.buttons-copy');\r\n\t\t\tdt.buttons.info(false);\r\n\t\t};\r\n\r\n\t\tcontainer.on('click.buttons-copy', function () {\r\n\t\t\tclose();\r\n\t\t\tcb();\r\n\t\t});\r\n\t\t$(document)\r\n\t\t\t.on('keydown.buttons-copy', function (e) {\r\n\t\t\t\tif (e.keyCode === 27) {\r\n\t\t\t\t\t// esc\r\n\t\t\t\t\tclose();\r\n\t\t\t\t\tcb();\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.on('copy.buttons-copy cut.buttons-copy', function () {\r\n\t\t\t\tclose();\r\n\t\t\t\tcb();\r\n\t\t\t});\r\n\t},\r\n\r\n\tasync: 100,\r\n\r\n\tcopySuccess: true,\r\n\r\n\texportOptions: {},\r\n\r\n\tfieldSeparator: '\\t',\r\n\r\n\tfieldBoundary: '',\r\n\r\n\theader: true,\r\n\r\n\tfooter: true,\r\n\r\n\ttitle: '*',\r\n\r\n\tmessageTop: '*',\r\n\r\n\tmessageBottom: '*'\r\n};\r\n\r\n//\r\n// CSV export\r\n//\r\nDataTable.ext.buttons.csvHtml5 = {\r\n\tbom: false,\r\n\r\n\tclassName: 'buttons-csv buttons-html5',\r\n\r\n\tavailable: function () {\r\n\t\treturn window.FileReader !== undefined && window.Blob;\r\n\t},\r\n\r\n\ttext: function (dt) {\r\n\t\treturn dt.i18n('buttons.csv', 'CSV');\r\n\t},\r\n\r\n\taction: function (e, dt, button, config, cb) {\r\n\t\t// Set the text\r\n\t\tvar output = _exportData(dt, config).str;\r\n\t\tvar info = dt.buttons.exportInfo(config);\r\n\t\tvar charset = config.charset;\r\n\r\n\t\tif (config.customize) {\r\n\t\t\toutput = config.customize(output, config, dt);\r\n\t\t}\r\n\r\n\t\tif (charset !== false) {\r\n\t\t\tif (!charset) {\r\n\t\t\t\tcharset = document.characterSet || document.charset;\r\n\t\t\t}\r\n\r\n\t\t\tif (charset) {\r\n\t\t\t\tcharset = ';charset=' + charset;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tcharset = '';\r\n\t\t}\r\n\r\n\t\tif (config.bom) {\r\n\t\t\toutput = String.fromCharCode(0xfeff) + output;\r\n\t\t}\r\n\r\n\t\t_saveAs(\r\n\t\t\tnew Blob([output], { type: 'text/csv' + charset }),\r\n\t\t\tinfo.filename,\r\n\t\t\ttrue\r\n\t\t);\r\n\r\n\t\tcb();\r\n\t},\r\n\r\n\tasync: 100,\r\n\r\n\tfilename: '*',\r\n\r\n\textension: '.csv',\r\n\r\n\texportOptions: {\r\n\t\tescapeExcelFormula: true\r\n\t},\r\n\r\n\tfieldSeparator: ',',\r\n\r\n\tfieldBoundary: '\"',\r\n\r\n\tescapeChar: '\"',\r\n\r\n\tcharset: null,\r\n\r\n\theader: true,\r\n\r\n\tfooter: true\r\n};\r\n\r\n//\r\n// Excel (xlsx) export\r\n//\r\nDataTable.ext.buttons.excelHtml5 = {\r\n\tclassName: 'buttons-excel buttons-html5',\r\n\r\n\tavailable: function () {\r\n\t\treturn (\r\n\t\t\twindow.FileReader !== undefined &&\r\n\t\t\t_jsZip() !== undefined &&\r\n\t\t\t!_isDuffSafari() &&\r\n\t\t\t_serialiser\r\n\t\t);\r\n\t},\r\n\r\n\ttext: function (dt) {\r\n\t\treturn dt.i18n('buttons.excel', 'Excel');\r\n\t},\r\n\r\n\taction: function (e, dt, button, config, cb) {\r\n\t\tvar rowPos = 0;\r\n\t\tvar dataStartRow, dataEndRow;\r\n\t\tvar getXml = function (type) {\r\n\t\t\tvar str = excelStrings[type];\r\n\r\n\t\t\t//str = str.replace( /xmlns:/g, 'xmlns_' ).replace( /mc:/g, 'mc_' );\r\n\r\n\t\t\treturn $.parseXML(str);\r\n\t\t};\r\n\t\tvar rels = getXml('xl/worksheets/sheet1.xml');\r\n\t\tvar relsGet = rels.getElementsByTagName('sheetData')[0];\r\n\r\n\t\tvar xlsx = {\r\n\t\t\t_rels: {\r\n\t\t\t\t'.rels': getXml('_rels/.rels')\r\n\t\t\t},\r\n\t\t\txl: {\r\n\t\t\t\t_rels: {\r\n\t\t\t\t\t'workbook.xml.rels': getXml('xl/_rels/workbook.xml.rels')\r\n\t\t\t\t},\r\n\t\t\t\t'workbook.xml': getXml('xl/workbook.xml'),\r\n\t\t\t\t'styles.xml': getXml('xl/styles.xml'),\r\n\t\t\t\tworksheets: {\r\n\t\t\t\t\t'sheet1.xml': rels\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t'[Content_Types].xml': getXml('[Content_Types].xml')\r\n\t\t};\r\n\r\n\t\tvar data = dt.buttons.exportData(config.exportOptions);\r\n\t\tvar currentRow, rowNode;\r\n\t\tvar addRow = function (row) {\r\n\t\t\tcurrentRow = rowPos + 1;\r\n\t\t\trowNode = _createNode(rels, 'row', { attr: { r: currentRow } });\r\n\r\n\t\t\tfor (var i = 0, ien = row.length; i < ien; i++) {\r\n\t\t\t\t// Concat both the Cell Columns as a letter and the Row of the cell.\r\n\t\t\t\tvar cellId = createCellPos(i) + '' + currentRow;\r\n\t\t\t\tvar cell = null;\r\n\r\n\t\t\t\t// For null, undefined of blank cell, continue so it doesn't create the _createNode\r\n\t\t\t\tif (row[i] === null || row[i] === undefined || row[i] === '') {\r\n\t\t\t\t\tif (config.createEmptyCells === true) {\r\n\t\t\t\t\t\trow[i] = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar originalContent = row[i];\r\n\t\t\t\trow[i] =\r\n\t\t\t\t\ttypeof row[i].trim === 'function' ? row[i].trim() : row[i];\r\n\r\n\t\t\t\t// Special number formatting options\r\n\t\t\t\tfor (var j = 0, jen = _excelSpecials.length; j < jen; j++) {\r\n\t\t\t\t\tvar special = _excelSpecials[j];\r\n\r\n\t\t\t\t\t// TODO Need to provide the ability for the specials to say\r\n\t\t\t\t\t// if they are returning a string, since at the moment it is\r\n\t\t\t\t\t// assumed to be a number\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\trow[i].match &&\r\n\t\t\t\t\t\t!row[i].match(/^0\\d+/) &&\r\n\t\t\t\t\t\trow[i].match(special.match)\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tvar val = row[i].replace(/[^\\d\\.\\-]/g, '');\r\n\r\n\t\t\t\t\t\tif (special.fmt) {\r\n\t\t\t\t\t\t\tval = special.fmt(val);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcell = _createNode(rels, 'c', {\r\n\t\t\t\t\t\t\tattr: {\r\n\t\t\t\t\t\t\t\tr: cellId,\r\n\t\t\t\t\t\t\t\ts: special.style\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tchildren: [_createNode(rels, 'v', { text: val })]\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!cell) {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\ttypeof row[i] === 'number' ||\r\n\t\t\t\t\t\t(row[i].match &&\r\n\t\t\t\t\t\t\trow[i].match(/^-?\\d+(\\.\\d+)?([eE]\\-?\\d+)?$/) && // Includes exponential format\r\n\t\t\t\t\t\t\t!row[i].match(/^0\\d+/))\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\t// Detect numbers - don't match numbers with leading zeros\r\n\t\t\t\t\t\t// or a negative anywhere but the start\r\n\t\t\t\t\t\tcell = _createNode(rels, 'c', {\r\n\t\t\t\t\t\t\tattr: {\r\n\t\t\t\t\t\t\t\tt: 'n',\r\n\t\t\t\t\t\t\t\tr: cellId\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tchildren: [_createNode(rels, 'v', { text: row[i] })]\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t// String output - replace non standard characters for text output\r\n\t\t\t\t\t\t/*eslint no-control-regex: \"off\"*/\r\n\t\t\t\t\t\tvar text = !originalContent.replace\r\n\t\t\t\t\t\t\t? originalContent\r\n\t\t\t\t\t\t\t: originalContent.replace(\r\n\t\t\t\t\t\t\t\t\t/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g,\r\n\t\t\t\t\t\t\t\t\t''\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tcell = _createNode(rels, 'c', {\r\n\t\t\t\t\t\t\tattr: {\r\n\t\t\t\t\t\t\t\tt: 'inlineStr',\r\n\t\t\t\t\t\t\t\tr: cellId\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tchildren: {\r\n\t\t\t\t\t\t\t\trow: _createNode(rels, 'is', {\r\n\t\t\t\t\t\t\t\t\tchildren: {\r\n\t\t\t\t\t\t\t\t\t\trow: _createNode(rels, 't', {\r\n\t\t\t\t\t\t\t\t\t\t\ttext: text,\r\n\t\t\t\t\t\t\t\t\t\t\tattr: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t'xml:space': 'preserve'\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\trowNode.appendChild(cell);\r\n\t\t\t}\r\n\r\n\t\t\trelsGet.appendChild(rowNode);\r\n\t\t\trowPos++;\r\n\t\t};\r\n\r\n\t\tvar addHeader = function (structure) {\r\n\t\t\tstructure.forEach(function (row) {\r\n\t\t\t\taddRow(\r\n\t\t\t\t\trow.map(function (cell) {\r\n\t\t\t\t\t\treturn cell ? cell.title : '';\r\n\t\t\t\t\t}),\r\n\t\t\t\t\trowPos\r\n\t\t\t\t);\r\n\t\t\t\t$('row:last c', rels).attr('s', '2'); // bold\r\n\r\n\t\t\t\t// Add any merge cells\r\n\t\t\t\trow.forEach(function (cell, columnCounter) {\r\n\t\t\t\t\tif (cell && (cell.colSpan > 1 || cell.rowSpan > 1)) {\r\n\t\t\t\t\t\t_excelMergeCells(\r\n\t\t\t\t\t\t\trels,\r\n\t\t\t\t\t\t\trowPos,\r\n\t\t\t\t\t\t\tcolumnCounter,\r\n\t\t\t\t\t\t\tcell.rowSpan,\r\n\t\t\t\t\t\t\tcell.colSpan\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t// Title and top messages\r\n\t\tvar exportInfo = dt.buttons.exportInfo(config);\r\n\t\tif (exportInfo.title) {\r\n\t\t\taddRow([exportInfo.title], rowPos);\r\n\t\t\t_excelMergeCells(rels, rowPos, 0, 1, data.header.length);\r\n\t\t\t$('row:last c', rels).attr('s', '51'); // centre\r\n\t\t}\r\n\r\n\t\tif (exportInfo.messageTop) {\r\n\t\t\taddRow([exportInfo.messageTop], rowPos);\r\n\t\t\t_excelMergeCells(rels, rowPos, 0, 1, data.header.length);\r\n\t\t}\r\n\r\n\t\t// Table header\r\n\t\tif (config.header) {\r\n\t\t\taddHeader(data.headerStructure);\r\n\t\t}\r\n\r\n\t\tdataStartRow = rowPos;\r\n\r\n\t\t// Table body\r\n\t\tfor (var n = 0, ie = data.body.length; n < ie; n++) {\r\n\t\t\taddRow(data.body[n], rowPos);\r\n\t\t}\r\n\r\n\t\tdataEndRow = rowPos;\r\n\r\n\t\t// Table footer\r\n\t\tif (config.footer && data.footer) {\r\n\t\t\taddHeader(data.footerStructure);\r\n\t\t}\r\n\r\n\t\t// Below the table\r\n\t\tif (exportInfo.messageBottom) {\r\n\t\t\taddRow([exportInfo.messageBottom], rowPos);\r\n\t\t\t_excelMergeCells(rels, rowPos, 0, 1, data.header.length);\r\n\t\t}\r\n\r\n\t\t// Set column widths\r\n\t\tvar cols = _createNode(rels, 'cols');\r\n\t\t$('worksheet', rels).prepend(cols);\r\n\r\n\t\tfor (var i = 0, ien = data.header.length; i < ien; i++) {\r\n\t\t\tcols.appendChild(\r\n\t\t\t\t_createNode(rels, 'col', {\r\n\t\t\t\t\tattr: {\r\n\t\t\t\t\t\tmin: i + 1,\r\n\t\t\t\t\t\tmax: i + 1,\r\n\t\t\t\t\t\twidth: _excelColWidth(data, i),\r\n\t\t\t\t\t\tcustomWidth: 1\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Workbook modifications\r\n\t\tvar workbook = xlsx.xl['workbook.xml'];\r\n\r\n\t\t$('sheets sheet', workbook).attr('name', _sheetname(config));\r\n\r\n\t\t// Auto filter for columns\r\n\t\tif (config.autoFilter) {\r\n\t\t\t$('mergeCells', rels).before(\r\n\t\t\t\t_createNode(rels, 'autoFilter', {\r\n\t\t\t\t\tattr: {\r\n\t\t\t\t\t\tref:\r\n\t\t\t\t\t\t\t'A' +\r\n\t\t\t\t\t\t\tdataStartRow +\r\n\t\t\t\t\t\t\t':' +\r\n\t\t\t\t\t\t\tcreateCellPos(data.header.length - 1) +\r\n\t\t\t\t\t\t\tdataEndRow\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t);\r\n\r\n\t\t\t$('definedNames', workbook).append(\r\n\t\t\t\t_createNode(workbook, 'definedName', {\r\n\t\t\t\t\tattr: {\r\n\t\t\t\t\t\tname: '_xlnm._FilterDatabase',\r\n\t\t\t\t\t\tlocalSheetId: '0',\r\n\t\t\t\t\t\thidden: 1\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttext:\r\n\t\t\t\t\t\t'\\'' +\r\n\t\t\t\t\t\t_sheetname(config).replace(/'/g, '\\'\\'') +\r\n\t\t\t\t\t\t'\\'!$A$' +\r\n\t\t\t\t\t\tdataStartRow +\r\n\t\t\t\t\t\t':$' +\r\n\t\t\t\t\t\tcreateCellPos(data.header.length - 1) +\r\n\t\t\t\t\t\t'$' +\r\n\t\t\t\t\t\tdataEndRow\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Let the developer customise the document if they want to\r\n\t\tif (config.customize) {\r\n\t\t\tconfig.customize(xlsx, config, dt);\r\n\t\t}\r\n\r\n\t\t// Excel doesn't like an empty mergeCells tag\r\n\t\tif ($('mergeCells', rels).children().length === 0) {\r\n\t\t\t$('mergeCells', rels).remove();\r\n\t\t}\r\n\r\n\t\tvar jszip = _jsZip();\r\n\t\tvar zip = new jszip();\r\n\t\tvar zipConfig = {\r\n\t\t\tcompression: 'DEFLATE',\r\n\t\t\ttype: 'blob',\r\n\t\t\tmimeType:\r\n\t\t\t\t'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\r\n\t\t};\r\n\r\n\t\t_addToZip(zip, xlsx);\r\n\r\n\t\t// Modern Excel has a 218 character limit on the file name + path of the file (why!?)\r\n\t\t// https://support.microsoft.com/en-us/office/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3\r\n\t\t// So we truncate to allow for this.\r\n\t\tvar filename = exportInfo.filename;\r\n\r\n\t\tif (filename > 175) {\r\n\t\t\tfilename = filename.substr(0, 175);\r\n\t\t}\r\n\r\n\t\t// Let the developer customize the final zip file if they want to before it is generated and sent to the browser\r\n\t\tif (config.customizeZip) {\r\n\t\t\tconfig.customizeZip(zip, data, filename);\r\n\t\t}\r\n\r\n\r\n\t\tif (zip.generateAsync) {\r\n\t\t\t// JSZip 3+\r\n\t\t\tzip.generateAsync(zipConfig).then(function (blob) {\r\n\t\t\t\t_saveAs(blob, filename);\r\n\t\t\t\tcb();\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// JSZip 2.5\r\n\t\t\t_saveAs(zip.generate(zipConfig), filename);\r\n\t\t\tcb();\r\n\t\t}\r\n\t},\r\n\r\n\tasync: 100,\r\n\r\n\tfilename: '*',\r\n\r\n\textension: '.xlsx',\r\n\r\n\texportOptions: {},\r\n\r\n\theader: true,\r\n\r\n\tfooter: true,\r\n\r\n\ttitle: '*',\r\n\r\n\tmessageTop: '*',\r\n\r\n\tmessageBottom: '*',\r\n\r\n\tcreateEmptyCells: false,\r\n\r\n\tautoFilter: false,\r\n\r\n\tsheetName: ''\r\n};\r\n\r\n//\r\n// PDF export - using pdfMake - http://pdfmake.org\r\n//\r\nDataTable.ext.buttons.pdfHtml5 = {\r\n\tclassName: 'buttons-pdf buttons-html5',\r\n\r\n\tavailable: function () {\r\n\t\treturn window.FileReader !== undefined && _pdfMake();\r\n\t},\r\n\r\n\ttext: function (dt) {\r\n\t\treturn dt.i18n('buttons.pdf', 'PDF');\r\n\t},\r\n\r\n\taction: function (e, dt, button, config, cb) {\r\n\t\tvar data = dt.buttons.exportData(config.exportOptions);\r\n\t\tvar info = dt.buttons.exportInfo(config);\r\n\t\tvar rows = [];\r\n\r\n\t\tif (config.header) {\r\n\t\t\tdata.headerStructure.forEach(function (row) {\r\n\t\t\t\trows.push(\r\n\t\t\t\t\trow.map(function (cell) {\r\n\t\t\t\t\t\treturn cell\r\n\t\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\t\ttext: cell.title,\r\n\t\t\t\t\t\t\t\t\tcolSpan: cell.colspan,\r\n\t\t\t\t\t\t\t\t\trowSpan: cell.rowspan,\r\n\t\t\t\t\t\t\t\t\tstyle: 'tableHeader'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t: {};\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfor (var i = 0, ien = data.body.length; i < ien; i++) {\r\n\t\t\trows.push(\r\n\t\t\t\tdata.body[i].map(function (d) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\ttext:\r\n\t\t\t\t\t\t\td === null || d === undefined\r\n\t\t\t\t\t\t\t\t? ''\r\n\t\t\t\t\t\t\t\t: typeof d === 'string'\r\n\t\t\t\t\t\t\t\t? d\r\n\t\t\t\t\t\t\t\t: d.toString()\r\n\t\t\t\t\t};\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tif (config.footer) {\r\n\t\t\tdata.footerStructure.forEach(function (row) {\r\n\t\t\t\trows.push(\r\n\t\t\t\t\trow.map(function (cell) {\r\n\t\t\t\t\t\treturn cell\r\n\t\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\t\ttext: cell.title,\r\n\t\t\t\t\t\t\t\t\tcolSpan: cell.colspan,\r\n\t\t\t\t\t\t\t\t\trowSpan: cell.rowspan,\r\n\t\t\t\t\t\t\t\t\tstyle: 'tableFooter'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t: {};\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tvar doc = {\r\n\t\t\tpageSize: config.pageSize,\r\n\t\t\tpageOrientation: config.orientation,\r\n\t\t\tcontent: [\r\n\t\t\t\t{\r\n\t\t\t\t\tstyle: 'table',\r\n\t\t\t\t\ttable: {\r\n\t\t\t\t\t\theaderRows: config.header\r\n\t\t\t\t\t\t\t? data.headerStructure.length\r\n\t\t\t\t\t\t\t: 0,\r\n\t\t\t\t\t\tfooterRows: config.footer // Used for styling, doesn't do anything in pdfmake\r\n\t\t\t\t\t\t\t? data.footerStructure.length\r\n\t\t\t\t\t\t\t: 0,\r\n\t\t\t\t\t\tbody: rows\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlayout: {\r\n\t\t\t\t\t\thLineWidth: function (i, node) {\r\n\t\t\t\t\t\t\tif (i === 0 || i === node.table.body.length) {\r\n\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn 0.5;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tvLineWidth: function () {\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\thLineColor: function (i, node) {\r\n\t\t\t\t\t\t\treturn i === node.table.headerRows ||\r\n\t\t\t\t\t\t\t\ti ===\r\n\t\t\t\t\t\t\t\t\tnode.table.body.length -\r\n\t\t\t\t\t\t\t\t\t\tnode.table.footerRows\r\n\t\t\t\t\t\t\t\t? '#333'\r\n\t\t\t\t\t\t\t\t: '#ddd';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfillColor: function (rowIndex) {\r\n\t\t\t\t\t\t\tif (rowIndex < data.headerStructure.length) {\r\n\t\t\t\t\t\t\t\treturn '#fff';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn rowIndex % 2 === 0 ? '#f3f3f3' : null;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tpaddingTop: function () {\r\n\t\t\t\t\t\t\treturn 5;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tpaddingBottom: function () {\r\n\t\t\t\t\t\t\treturn 5;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\tstyles: {\r\n\t\t\t\ttableHeader: {\r\n\t\t\t\t\tbold: true,\r\n\t\t\t\t\tfontSize: 11,\r\n\t\t\t\t\talignment: 'center'\r\n\t\t\t\t},\r\n\t\t\t\ttableFooter: {\r\n\t\t\t\t\tbold: true,\r\n\t\t\t\t\tfontSize: 11,\r\n\t\t\t\t\talignment: 'center'\r\n\t\t\t\t},\r\n\t\t\t\ttable: {\r\n\t\t\t\t\tmargin: [0, 5, 0, 5]\r\n\t\t\t\t},\r\n\t\t\t\ttitle: {\r\n\t\t\t\t\talignment: 'center',\r\n\t\t\t\t\tfontSize: 13\r\n\t\t\t\t},\r\n\t\t\t\tmessage: {}\r\n\t\t\t},\r\n\t\t\tdefaultStyle: {\r\n\t\t\t\tfontSize: 10\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif (info.messageTop) {\r\n\t\t\tdoc.content.unshift({\r\n\t\t\t\ttext: info.messageTop,\r\n\t\t\t\tstyle: 'message',\r\n\t\t\t\tmargin: [0, 0, 0, 12]\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (info.messageBottom) {\r\n\t\t\tdoc.content.push({\r\n\t\t\t\ttext: info.messageBottom,\r\n\t\t\t\tstyle: 'message',\r\n\t\t\t\tmargin: [0, 0, 0, 12]\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (info.title) {\r\n\t\t\tdoc.content.unshift({\r\n\t\t\t\ttext: info.title,\r\n\t\t\t\tstyle: 'title',\r\n\t\t\t\tmargin: [0, 0, 0, 12]\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (config.customize) {\r\n\t\t\tconfig.customize(doc, config, dt);\r\n\t\t}\r\n\r\n\t\tvar pdf = _pdfMake().createPdf(doc);\r\n\r\n\t\tif (config.download === 'open' && !_isDuffSafari()) {\r\n\t\t\tpdf.open();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpdf.download(info.filename);\r\n\t\t}\r\n\r\n\t\tcb();\r\n\t},\r\n\r\n\tasync: 100,\r\n\r\n\ttitle: '*',\r\n\r\n\tfilename: '*',\r\n\r\n\textension: '.pdf',\r\n\r\n\texportOptions: {},\r\n\r\n\torientation: 'portrait',\r\n\r\n\t// This isn't perfect, but it is close\r\n\tpageSize:\r\n\t\tnavigator.language === 'en-US' || navigator.language === 'en-CA'\r\n\t\t\t? 'LETTER'\r\n\t\t\t: 'A4',\r\n\r\n\theader: true,\r\n\r\n\tfooter: true,\r\n\r\n\tmessageTop: '*',\r\n\r\n\tmessageBottom: '*',\r\n\r\n\tcustomize: null,\r\n\r\n\tdownload: 'download'\r\n};\r\n\r\n\r\nreturn DataTable;\r\n}));\r\n"],
  "mappings": "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",
  "names": ["window", "document", "i", "ien", "e"]
}
